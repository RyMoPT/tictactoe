<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <head>
<title>Project: TicTacToe</title>
<link rel="stylesheet" type="text/css" href="style.css" />

<style>
.container {
    background-color: black;
    margin:auto;
    display:grid;
    height: 400px;
    width: 400px;
    grid-gap: 10px;
    grid-template-rows: repeat(3, 1fr);
    grid-template-columns: repeat(3, 1fr);
    grid-template-areas: 
        "box1 box2 box3"
        "box4 box5 box6"
        "box7 box8 box9"
}
.box1 {
    grid-area: box1;
    background-color: white;
    font-size: 100px;
    text-align: center;

}
.box2 {
    grid-area: box2;
    background-color: white;
    font-size: 100px;
    text-align: center;
}
.box3 {
    grid-area: box3;
    background-color: white;
    font-size: 100px;
    text-align: center;
}
.box4 {
    grid-area: box4;
    background-color: white;
    font-size: 100px;
    text-align: center;
}
.box5 {
    grid-area: box5;
    background-color: white;
    font-size: 100px;
    text-align: center;
}
.box6 {
    grid-area: box6;
    background-color: white;
    font-size: 100px;
    text-align: center;
}
.box7 {
    grid-area: box7;
    background-color: white;
    font-size: 100px;
    text-align: center;
}
.box8 {
    grid-area: box8;
    background-color: white;
    font-size: 100px;
    text-align: center;
}
.box9 {
    grid-area: box9;
    background-color: white;
    font-size: 100px;
    text-align: center;
}

</style>
    </head>
    <body>
        <div class="container">
                <div class="box1 box" id = '0, 0'></div>
                <div class="box2 box" id = '0, 1'></div>
                <div class="box3 box" id = '0, 2'></div>
                <div class="box4 box" id = '1, 0'></div>
                <div class="box5 box" id = '1, 1'></div>
                <div class="box6 box" id = '1, 2'></div>
                <div class="box7 box" id = '2, 0'></div>
                <div class="box8 box" id = '2, 1'></div>
                <div class="box9 box" id = '2, 2'></div>
            </div>
    <script> 
const players = (name) => {
    const getName = () => name;
    const sayName = () => console.log(`My name is ${name}`);
    return {getName, sayName}
}

const playerOne = players('playerOne');
const playerTwo = players('playerTwo');

const gameBoard = (() => {
    const playerMoves = [
        [,,,],
        [,,,],
        [,,,]
    ];
    return {playerMoves};
    
})();

const boxes = document.querySelectorAll('.box')

const gameFlow = (() => {
    const playerOneMove = () => {
        return 'x';
    }
    const playerTwoMove = () => {
        return 'o';        
    }
    const playerTurn = (counter) => {
            if (counter % 2 === 0) {
                return gameFlow.playerOneMove();
            } else {
                return gameFlow.playerTwoMove();
            }       
    } 
    return {playerTurn,playerOneMove,playerTwoMove}
})();

const checkWinner = (counter) => {
    if  (gameBoard.playerMoves[0][0]!= null && gameBoard.playerMoves[0][0] == gameBoard.playerMoves[0][1] && gameBoard.playerMoves[0][0]== gameBoard.playerMoves[0][2]) {
        return alert(`Winner is ${gameBoard.playerMoves[0][0]}`);
    } else if (gameBoard.playerMoves[1][0]!= null && gameBoard.playerMoves[1][0] == gameBoard.playerMoves[1][1] && gameBoard.playerMoves[1][0]== gameBoard.playerMoves[1][2]) {
        return alert(`Winner is ${gameBoard.playerMoves[1][0]}`);
    }else if (gameBoard.playerMoves[2][0]!= null && gameBoard.playerMoves[2][0] == gameBoard.playerMoves[2][1] && gameBoard.playerMoves[2][0]== gameBoard.playerMoves[2][2]) {
        return alert(`Winner is ${gameBoard.playerMoves[2][0]}`);
    }else if (gameBoard.playerMoves[0][0]!= null && gameBoard.playerMoves[0][0] == gameBoard.playerMoves[1][1] && gameBoard.playerMoves[0][0]== gameBoard.playerMoves[2][2]) {
        return alert(`Winner is ${gameBoard.playerMoves[0][0]}`); 
    }else if (gameBoard.playerMoves[2][0]!= null && gameBoard.playerMoves[2][0] == gameBoard.playerMoves[1][1] && gameBoard.playerMoves[2][0]== gameBoard.playerMoves[0][2]) {
        return alert(`Winner is ${gameBoard.playerMoves[2][0]}`);
    }else if (gameBoard.playerMoves[0][1]!= null && gameBoard.playerMoves[0][1] == gameBoard.playerMoves[1][1] && gameBoard.playerMoves[0][1]== gameBoard.playerMoves[2][1]) {
        return alert(`Winner is ${gameBoard.playerMoves[0][1]}`);
    }else if (gameBoard.playerMoves[0][0]!= null && gameBoard.playerMoves[0][0] == gameBoard.playerMoves[1][0] && gameBoard.playerMoves[0][0]== gameBoard.playerMoves[2][0]) {
        return alert(`Winner is ${gameBoard.playerMoves[0][0]}`);
    }else if (gameBoard.playerMoves[0][2]!= null && gameBoard.playerMoves[0][2] == gameBoard.playerMoves[1][2] && gameBoard.playerMoves[0][2]== gameBoard.playerMoves[2][2]) {
        return alert(`Winner is ${gameBoard.playerMoves[0][2]}`);
    }else if (counter === 9){
        return alert('Tie game');
    }
}

const displayController = (() => {
    //starting counter to keep track of turns
    let counter = 0;
    //add event listener to all boxes
    for (i = 0; boxes.length > 0; i++) {        
        boxes[i].addEventListener('click', function(e) {

        if (e.target.innerText === 'x' || e.target.innerText === 'o') {
            return;
        } else{
            console.log(gameFlow.playerTurn(counter));
        e.target.innerText = gameFlow.playerTurn(counter);
        console.log(e.target.id);
        let arrayNavX = e.target.id.slice(0,1);
        console.log(arrayNavX);
        let arrayNavY = e.target.id.slice(3);
        console.log(arrayNavY);
        gameBoard.playerMoves[arrayNavX][arrayNavY] = e.target.innerText
        counter ++;
        console.log(counter);
        if (counter === 9){
            checkWinner(counter);
        } else {
    let boxesArray = [...boxes];
    let emptySpaces=[]
    boxesArray.forEach(function(e) {
        if (e.innerText === '') {
            emptySpaces.push(e.id);
        }
    }  
)
        let nextPosition = emptySpaces[Math.floor(Math.random()*emptySpaces.length)];
        let nextPositionX = nextPosition.slice(0,1);
        let nextPositionY = nextPosition.slice(3);
        console.log(nextPositionX,nextPositionY);
        gameBoard.playerMoves[nextPositionX][nextPositionY] = 'o';
        boxesArray.forEach(function(e) {
            if (e.id === nextPosition) {
                e.innerText='o';
        }})
    counter ++;
    checkWinner(counter);
        }}
        })}
})();




    </script>
    </body>
    <footer>
        <h1>Designed by <a href='https://github.com/RyMoPT'>RyMoPT</a></h1>
    </footer>
</html>